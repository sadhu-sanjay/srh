<div
  class="sticky -top-[140dvh] h-[140dvh] w-full opacity-0 transition-all delay-700 duration-1000"
  id="svg-circles"
>
  <svg
    xmlns="http://www.w3.org/2000/svg"
    viewBox="0 0 200 200"
    width="100%"
    height="100%"
    id="svgEl"
  >
    <defs>
      <filter id="shadow" x="-50%" y="-50%" width="200%" height="200%">
        <feDropShadow
          dx="0"
          dy="0"
          stdDeviation="5"
          flood-color="#000000"
          flood-opacity="0.2"></feDropShadow>
      </filter>
    </defs>
  </svg>

  <h1
    id="fame"
    class="absolute -top-full left-1/2 w-[100dvw] -translate-x-1/2 text-[35dvw] font-black leading-none text-secondary-accent transition-all delay-1000 duration-1000"
  >
    F<span class="relative inline-block"
      >A<div
        id="builders"
        class="absolute -left-full top-[87%] w-auto text-8xl font-black leading-none text-secondary-accent transition-all delay-1000 duration-1000"
      >
        BUILDERS
        <div class="leading-2 w-5/6 text-xl font-normal text-secondary-accent">
          SRH spans entertainment and advertising, giving you access to top
          talent and big ideas. <br />
          <br /> We believe that big, bold stunts can be the most efficient way to
          build mental availability (1).
        </div>
      </div></span
    >ME
  </h1>

  <script>
    // Array to hold the circle data (cx, cy, radius, and fill)
    const circlesData = [
      { cx: -20, cy:-40, cx1: 120, cy1: 130,cx2: 30, cy2: 0, r: 25,   fill: "rgba(0,250,250, 0.9)",      fill1: "rgba(0,250,250, 0.9)",    },
      { cx: -20, cy:-40, cx1: 180, cy1: 130,cx2: 30, cy2: 15, r: 25,  fill: "rgba(0,250, 250 , 0.9)",    fill1: "rgba(0,250, 250 , 0.9)",  },
      { cx: -20, cy:-40, cx1: 120, cy1: 10, cx2: 30, cy2: 30, r: 25,  fill: "rgba(0, 250, 0, 0.9)",      fill1: "rgba(0, 250, 0, 0.9)",    },
      { cx: -20, cy:-40, cx1: 180, cy1: 10, cx2: 30, cy2: 45, r: 25,  fill: "rgba( 0, 250, 0  , 0.9)",   fill1: "rgba( 0, 250, 0  , 0.9)", },
      { cx: -20, cy:-40, cx1: 0,   cy1: 70, cx2: 30, cy2: 60, r: 25,  fill: "rgba( 250,250,0, 0.9)",     fill1: "rgba( 250,250,0, 0.9)",   },
      { cx: -20, cy:-40, cx1: 60,  cy1: 70, cx2: 30, cy2: 75, r: 25,  fill: "rgba( var(--accent), 0.3)", fill1: "rgba(var(--accent), 0.9)", },
      { cx: 120, cy: 90, cx1: 0,   cy1: 130,cx2: 30, cy2: 90, r: 100, fill: "rgba( var(--accent), 0.4)", fill1: "rgba(var(--accent), 0.9)", },
      { cx: 100, cy: 90, cx1: 60 , cy1: 130,cx2: 30, cy2: 105, r: 85, fill: "rgba( var(--accent), 0.5)", fill1: "rgba(var(--accent), 0.9)", },
      { cx: 120, cy: 80, cx1: 0 ,  cy1: 10, cx2: 30, cy2: 120, r: 70, fill: "rgba(var(--accent), 0.4)",  fill1: "rgba(var(--accent), 0.9)", },
      { cx: 80,  cy: 80, cx1: 60 , cy1: 10, cx2: 30, cy2: 135, r: 55, fill: "rgba(var(--accent), 0.4)",  fill1: "rgba(var(--accent), 0.9)", },
      { cx: 130, cy: 100,cx1: 180, cy1: 70, cx2: 30, cy2: 150, r: 40, fill: "rgba(var(--accent), 0.4)",  fill1: "rgba(var(--accent), 0.9)", },
      { cx: 130, cy: 80, cx1: 120, cy1: 70, cx2: 30, cy2: 165, r: 25, fill: "rgba(var(--accent), 0.4)",  fill1: "rgba(var(--accent), 0.9)", },
    ];

    const break5 = 35;
    const break6 = 42;
    const break7 = 49;
    const break8 = 56;
    const break9 = 63;
    const break10 = 70;
    const break11 = 77;
    const break12 = 84;

    const svg = document.getElementById("svgEl") as HTMLElement;
    // Iterate over the circle data and create each circle programmatically
    circlesData.forEach((data: any) => {
      // Create a new circle element using the SVG namespace
      const circle = document.createElementNS(
        "http://www.w3.org/2000/svg",
        "circle"
      );

      // Set the attributes for the circle
      circle.setAttribute("cx", data.cx);
      circle.setAttribute("cy", data.cy);
      circle.setAttribute("r", data.r);
      circle.setAttribute("fill", data.fill);

      // Append the circle to the SVG element
      svg.appendChild(circle);
    });

    const elementScroll = document.getElementById("main-window");
    const builders = document.getElementById("builders") as HTMLElement;
    const textFame = document.getElementById("fame") as HTMLElement;
    const circles = document.querySelectorAll("#svg-circles circle");

    function animatePos(
      circle: SVGElement,
      targetCx: number,
      targetCy: number,
      targetR: number,
      fill?: string | undefined,
      duration: number = 700
    ) {

      const startTime = performance.now();
      const initialCx = parseFloat(circle.getAttribute("cx") || "0");
      const initialCy = parseFloat(circle.getAttribute("cy") || "0");
      const initialR = parseFloat(circle.getAttribute("r") || "0");
      const deltaCx = targetCx - initialCx;
      const deltaCy = targetCy - initialCy;
      const deltaR = targetR - initialR;

      function animate(time: number) {
        const elapsed = time - startTime;

        const progress = Math.min(elapsed / duration, 1);

        const newCx = initialCx + deltaCx * progress;
        const newCy = initialCy + deltaCy * progress;
        const newR = initialR + deltaR * progress;

        circle.setAttribute("cx", newCx.toString());
        circle.setAttribute("cy", newCy.toString());
        circle.setAttribute("r", newR.toString());

        if (fill) {
          circle.setAttribute("fill", fill)
        }

        if (progress < 1) {
          requestAnimationFrame(animate);
        }
      }

      requestAnimationFrame(animate);
    }

    elementScroll?.addEventListener("scroll", (el: Event) => {
      const target = el.target as HTMLElement;
      const scrollableHeight = target.scrollHeight - window.outerHeight;
      const scrollPercentage = (target.scrollTop / scrollableHeight) * 100;

      if (scrollPercentage > break5 && scrollPercentage <= break6) {
        textFame.style.top = "-100%";
        builders.style.left = "-100%";
        circles.forEach((circle: any, index) =>
          animatePos(
            circle,
            circlesData[index].cx,
            circlesData[index].cy,
            circlesData[index].r
          )
        );
      } else if (scrollPercentage > break6 && scrollPercentage <= break7) {
        textFame.style.top = "0%";
        builders.style.left = "0%";

        circles.forEach((circle: any, index) =>
          animatePos(circle, 120, 90, circlesData[index].r)
        );
      } else if (scrollPercentage > break7 && scrollPercentage <= break8) {
        textFame.style.top = "-100%";
        builders.style.left = "-100%";

        circles.forEach((circle: any, index: number) => animatePos(circle, 120, 90, 25, circlesData[index].fill ));
      } else if (scrollPercentage > break8 && scrollPercentage <= break9) {
        console.log("Cirle", scrollPercentage)

        circles.forEach((circle: any, index: number) => animatePos(circle, circlesData[index].cx1, circlesData[index].cy1, 25, circlesData[index].fill1));

      } else if (scrollPercentage > break9 && scrollPercentage <= break10) {
 
        circles.forEach((circle: any, index: number) => animatePos(circle, circlesData[index].cx2, circlesData[index].cy2, 6));
      }
    });
  </script>
</div>
